{"version":3,"sources":["../../../src/config/session.ts"],"sourcesContent":["import session from 'express-session';\nimport RedisStore from 'connect-redis';\nimport { NODE_ENV, SECRET_KEY } from '@/config/index';\nimport { RedisService } from '@/config/redis';\n\n/**\n * A service class to manage session middleware with Redis store.\n * It handles the configuration of the session middleware and ensures Redis connectivity.\n */\nexport class SessionService {\n  private redisService: RedisService;\n\n  /**\n   * Initializes a new instance of the SessionService class.\n   * Uses the singleton RedisService instance to manage Redis connections.\n   */\n  constructor() {\n    this.redisService = RedisService.getInstance(); // Get the singleton instance of RedisService\n  }\n\n  /**\n   * Initializes and configures session middleware with Redis store.\n   * @returns A promise that resolves to the session middleware configuration.\n   */\n  initialize() {\n    // Return the configured session middleware\n    return session({\n      store: new RedisStore({\n        client: this.redisService.client, // Use the Redis client from RedisService\n      }),\n      secret: SECRET_KEY || 'defaultSecret', // Fallback to a default secret if not provided\n      resave: false, // Avoid resaving sessions if they are not modified\n      saveUninitialized: false, // Only save sessions that are initialized\n      cookie: {\n        httpOnly: true, // Prevent client-side scripts from accessing the cookie\n        secure: NODE_ENV === 'production', // Use secure cookies only in production\n        maxAge: 1000 * 60 * 60 * 24, // Set cookie expiration to 1 day\n      },\n    });\n  }\n}\n"],"names":["SessionService","initialize","session","store","RedisStore","client","redisService","secret","SECRET_KEY","resave","saveUninitialized","cookie","httpOnly","secure","NODE_ENV","maxAge","constructor","RedisService","getInstance"],"mappings":";;;;+BASaA;;;eAAAA;;;uEATO;qEACG;uBACc;uBACR;;;;;;;;;;;;;;;;;;;AAMtB,IAAA,AAAMA,iBAAN,MAAMA;IAeXC,aAAa;QAEX,OAAOC,IAAAA,uBAAO,EAAC;YACbC,OAAO,IAAIC,qBAAU,CAAC;gBACpBC,QAAQ,IAAI,CAACC,YAAY,CAACD,MAAM;YAClC;YACAE,QAAQC,iBAAU,IAAI;YACtBC,QAAQ;YACRC,mBAAmB;YACnBC,QAAQ;gBACNC,UAAU;gBACVC,QAAQC,eAAQ,KAAK;gBACrBC,QAAQ,OAAO,KAAK,KAAK;YAC3B;QACF;IACF;IAvBAC,aAAc;QANd,uBAAQV,gBAAR,KAAA;QAOE,IAAI,CAACA,YAAY,GAAGW,mBAAY,CAACC,WAAW;IAC9C;AAsBF"}